<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>L·ªãch h·ªçc ‚Äî QLTT L·ªõp h·ªçc</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <div class="app" role="application">
    <aside class="sidebar" aria-label="Thanh ƒëi·ªÅu h∆∞·ªõng">
      <div class="brand">
        <div class="logo">QL</div>
        <div>
          <div class="title">QLTT L·ªõp h·ªçc</div>
          <div style="font-size:12px;color:var(--muted)">Qu·∫£n l√Ω th√¥ng tin l·ªõp & sinh vi√™n</div>
        </div>
      </div>

      <div class="profile-mini" id="sidebar-profile">
        <div id="side-avatar" style="width:44px;height:44px;border-radius:8px;background:#f3f4f6;overflow:hidden;display:flex;align-items:center;justify-content:center;border:1px solid rgba(0,0,0,0.04)">
          <img id="side-avatar-img" src="" alt="avatar" style="width:100%;height:100%;object-fit:cover;display:none">
          <div id="side-avatar-placeholder" style="font-weight:700;color:var(--muted)">U</div>
        </div>
        <div class="info">
          <div id="side-name" style="font-weight:700">Kh√°ch</div>
          <div id="side-role" style="font-size:12px;color:var(--muted)">Kh√¥ng c√≥ phi√™n</div>
        </div>
      </div>

      <nav class="side-nav" aria-label="Ch·ª©c nƒÉng">
        <button id="nav-dash">T·ªïng quan</button>
        <button id="nav-classes">L·ªõp h·ªçc</button>
        <button id="nav-schedule" class="active">L·ªãch</button>
        <button id="nav-grades">ƒêi·ªÉm s·ªë</button>
        <button id="nav-attendance">ƒêi·ªÉm danh</button>
        <button id="nav-students">Sinh vi√™n</button>
        <button id="nav-settings">C√†i ƒë·∫∑t</button>
      </nav>

      <div style="margin-top:auto; display:flex; gap:8px; align-items:center; justify-content:center">
        <button id="nav-profile" style="padding:8px 12px;border-radius:10px;border:1px solid rgba(16,24,40,0.06);background:transparent;cursor:pointer">H·ªì s∆°</button>
        <button id="nav-logout" style="padding:8px 12px;border-radius:10px;background:var(--accent);color:#fff;border:none;cursor:pointer">ƒêƒÉng xu·∫•t</button>
      </div>
    </aside>

    <section class="main" aria-live="polite">
      <div class="topbar">
        <div style="display:flex; gap:12px; align-items:center;">
          <button id="backToHome" style="background: transparent; border: 1px solid rgba(16,24,40,0.06); padding: 8px 12px; border-radius: 8px; cursor: pointer; color: var(--muted); font-size: 14px; display: flex; align-items: center; gap: 6px;" title="Quay v·ªÅ trang ch·ªß">
            ‚Üê Quay v·ªÅ
          </button>
          <h2 style="margin:0">L·ªãch h·ªçc</h2>
          <div style="font-size:13px;color:var(--muted)">Xem l·ªãch h·ªçc theo tu·∫ßn</div>
        </div>

        <div class="search">
          <input id="global-search" placeholder="T√¨m l·ªõp, m√¥n h·ªçc, ph√≤ng..." />
          <div class="top-actions">
            <button class="icon-btn" id="notifBtn" title="Th√¥ng b√°o">üîî</button>
            <button class="icon-btn" id="quickAdd">Ôºã</button>
            <div style="display:flex; align-items:center; gap:8px;">
              <div id="nav-avatar" style="width:40px;height:40px;border-radius:10px;overflow:hidden;border:1px solid rgba(0,0,0,0.04);display:flex;align-items:center;justify-content:center">
                <img id="nav-avatar-img" src="" alt="Avatar" style="width:100%;height:100%;object-fit:cover;display:none">
                <div id="nav-avatar-placeholder" style="font-weight:700;color:var(--muted)">U</div>
              </div>
              <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <div id="nav-user" style="font-weight:700">Kh√°ch</div>
                <div style="font-size:12px;color:var(--muted)" id="nav-role">‚Äî</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="schedule-container">
        <div class="calendar-section">
          <div class="calendar-header">
            <div class="week-navigation">
              <button class="week-nav-btn" id="prevWeek">‚Äπ Tu·∫ßn tr∆∞·ªõc</button>
              <div class="current-week" id="currentWeek">Tu·∫ßn 1 - 6/1/2025 ƒë·∫øn 12/1/2025</div>
              <button class="week-nav-btn" id="nextWeek">Tu·∫ßn sau ‚Ä∫</button>
            </div>
            <button class="week-nav-btn" id="todayBtn">H√¥m nay</button>
          </div>

          <div class="calendar-grid" id="calendarGrid">
            <!-- Time slots and days will be generated by JavaScript -->
          </div>

          <div class="legend">
            <div class="legend-item">
              <div class="legend-color primary"></div>
              <span>L·ªõp c·ªßa b·∫°n</span>
            </div>
            <div class="legend-item">
              <div class="legend-color secondary"></div>
              <span>L·ªõp kh√°c</span>
            </div>
          </div>
        </div>

        <div class="upcoming-section">
          <div class="upcoming-card">
            <h3 style="margin:0 0 12px 0">L·ªãch s·∫Øp t·ªõi</h3>
            <div id="upcomingList">
              <!-- Upcoming classes will be generated by JavaScript -->
            </div>
          </div>

          <div class="upcoming-card">
            <h3 style="margin:0 0 12px 0">Th·ªëng k√™ tu·∫ßn</h3>
            <div class="stats">
              <div class="stat">
                <h3 id="totalClasses">0</h3>
                <p>Ti·∫øt h·ªçc</p>
              </div>
              <div class="stat">
                <h3 id="totalHours">0</h3>
                <p>Gi·ªù h·ªçc</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <footer>
        &copy; 2025 QLTT L·ªõp h·ªçc ‚Äî H·ªá th·ªëng qu·∫£n l√Ω th√¥ng tin l·ªõp h·ªçc
      </footer>
    </section>
  </div>

  <script src="assets/js/main.js"></script>
  <script src="assets/js/schedule.js"></script>
  <script>
    // Profile and navigation logic (same as index.html)
    (function(){
      const navUser = document.getElementById('nav-user');
      const navAvatarImg = document.getElementById('nav-avatar-img');
      const navAvatarPlaceholder = document.getElementById('nav-avatar-placeholder');
      const profileBtn = document.getElementById('nav-profile');
      const logoutBtn = document.getElementById('nav-logout');

      function getSessionEmail(){ return (localStorage.getItem('sessionEmail') || '').toLowerCase(); }
      function loadProfile(email){
        if(!email) return null;
        try{ const raw = localStorage.getItem('profile::' + email.toLowerCase()); if(raw) return JSON.parse(raw); }catch(e){}
        return { name: email.split('@')[0] || '', email: email, phone: '', address: '', role: 'student', avatar: null };
      }

      function initNav(){
        const email = getSessionEmail();
        if(email){
          const profile = loadProfile(email);
          navUser.textContent = (profile && profile.name) ? profile.name : email;
          if(profile && profile.avatar){
            navAvatarImg.src = profile.avatar;
            navAvatarImg.style.display = 'block';
            navAvatarPlaceholder.style.display = 'none';
          } else {
            navAvatarImg.src = '';
            navAvatarImg.style.display = 'none';
            navAvatarPlaceholder.textContent = (profile && profile.name && profile.name[0]) ? profile.name[0].toUpperCase() : 'U';
            navAvatarPlaceholder.style.display = 'flex';
          }
          // sidebar mini
          try {
            document.getElementById('side-name').textContent = (profile && profile.name) ? profile.name : email;
            document.getElementById('side-role').textContent = (profile && profile.role) ? profile.role : '‚Äî';
            const sideImg = document.getElementById('side-avatar-img');
            const sidePl = document.getElementById('side-avatar-placeholder');
            if(profile && profile.avatar){
              sideImg.src = profile.avatar; sideImg.style.display = 'block'; sidePl.style.display = 'none';
            } else { sideImg.style.display = 'none'; sidePl.textContent = (profile && profile.name && profile.name[0]) ? profile.name[0].toUpperCase() : 'U'; sidePl.style.display = 'flex'; }
          } catch(e){}
        } else {
          navUser.textContent = 'Kh√°ch';
          navAvatarImg.src = '';
          navAvatarImg.style.display = 'none';
          navAvatarPlaceholder.textContent = 'U';
          navAvatarPlaceholder.style.display = 'flex';
        }
      }

      // Navigation
      document.getElementById('nav-dash').addEventListener('click', () => window.location.href = 'index.html');
      document.getElementById('nav-classes').addEventListener('click', () => window.location.href = 'index.html');
      document.getElementById('nav-grades').addEventListener('click', () => window.location.href = 'grades.html');
      document.getElementById('nav-attendance').addEventListener('click', () => window.location.href = 'attendance.html');
      document.getElementById('nav-students').addEventListener('click', () => window.location.href = 'index.html');
      document.getElementById('nav-settings').addEventListener('click', () => window.location.href = 'index.html');
      
      // Back to home button
      document.getElementById('backToHome').addEventListener('click', () => {
        window.location.href = 'index.html';
      });
      
      logoutBtn.addEventListener('click', ()=>{
        try{ localStorage.removeItem('sessionEmail'); }catch(e){}
        window.location.href = './login.html';
      });

      initNav();
    })();
  </script>
</body>
</html>
